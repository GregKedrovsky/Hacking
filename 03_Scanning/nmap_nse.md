# NSE: Nmap Scripting Engine
> A mechanism that allows users to write (and share) simple scripts to automate a wide variety of networking tasks. It facilitates the automation of various tasks that can performed with nmap. All NSE scripts end with the extension .nse

- All NSE scripts available prepackaged with nmap can be found: `/usr/share/nmap/scripts/`
- [Reference](https://nmap.org/nsedoc/scripts/)

## Contents
- [](#)
- [](#)

## 







## General Usage & Syntax
- From [Nmap 30 Most Common Commands](nmap_common.md#nmap-scripting-engine)

|  #  | Description | Syntax |
| :-: | ----------- | ------ |
| 22 | Scan using default safe scripts| `nmap -sV -sC 192.168.20.128` |
| 23 | Get help for a script| `nmap –script-help=ssl-heartbleed` |
| 24 | Scan using a specific script| `nmap -sV -p 443 -script=ssl-heartbleed 192.168.20.133` |
| 25 | Update script database| `nmap –script-updatedb` |

## Useful NSE Scripts

|  #  | Description | Syntax |
| :-: | ----------- | ------ |
| 26 | Scan for UDP DDOS reflectors| `nmap -sU -A -PN -n -pU:19,53,123,161 -script=ntp-monlist,dns-recursion,snmp-sysdescr 192.168.20.2/24` |
| 27 | Gather page titles from HTTP Servers| `nmap –script=http-title 192.168.20.128` |
| 28 | Get HTTP headers of web services| `nmap –script=http-headers 192.168.20.128` |
| 29 | Find web apps from known paths| `nmap –script=http-enum 192.168.20.128` |
| 30 | Find exposed Netbios servers| `nmap -sU –script nbtstat.nse -p 137 192.168.20.128` |

## [Script Categories](https://subscription.packtpub.com/book/networking-and-servers/9781782168317/1/ch01lvl1sec11/script-categories)

|  Category  | Description |
| :--------: | ----------- |
|  **auth**  | NSE scripts related to user authentication. |
|  **broadcast**  | A very interesting category of scripts that use broadcast petitions to gather network information. |
|  **brute**  | A category for scripts that help conduct brute-force password auditing. |
|  **default**  | Scripts executed when a script scan is executed (-sC). |
|  **discovery**  | Scripts related to host and service discovery. |
|  **dos**  | Scripts related to denial-of-service attacks. |
|  **exploit**  | Scripts used to exploit security vulnerabilities. |
|  **external**  | This category is for scripts depending on a third-party service. |
|  **fuzzer**  | NSE scripts focused on fuzzing. |
|  **intrusive**  | A category for scripts that might crash something or generate a lot of network noise. Scripts that system administrators may consider intrusive go here. |
|  **malware**  | A category for scripts related to malware detection. |
|  **safe**  | Scripts that are considered safe in all situations. |
|  **version**  | Scripts for advanced version detection. |
|  **vuln**  | Scripts related to detecting and exploiting security vulnerabilities. |

## [NSE CLI Args](https://nmap.org/book/man-nse.html)
> A lot of information generated by the Nmap Scripts will fall under enumeration (the next stage of the pentest). 

1. `-sC`
- Performs a script scan using the default set of scripts.

2. `--script <filename>|<category>|<directory>/|<expression>[,...]`
- Runs a script scan using the comma-separated list of filenames, script categories, and directories.
  - For a category: `nmap --script [categetory name]` or `nmap --script=[category name]`
  - You do not need to include the .nse extention when reference the script you want to run
- Also, you can use either whitespace (a space) or an equal sign between --script and the script-name
  - Example: `nmap -sS -sV --script mongodb-info -p 6421 -T4 192.224.77.3`
  - Same as: `nmap -sS -sV --script=mongodb-info -p 6421 -T4 192.224.77.3`

3. `--script-args <args>`
- Provides arguments to the scripts. Reference.

4. `--script-args-file <filename>`
- This option is the same as `--script-args` except that you pass the arguments in a file rather than on the command-line.

5. `--script-help <filename>|<category>|<directory>|<expression>|all[,...]`
- Shows help about scripts. 
- For each script matching the given specification, Nmap prints the script name, its categories, and its description. 
- Example: `nmap --script-help ssl-enum-ciphers` or `nmap --script-help=ssl-enum-ciphers`




