# Server Side Template Injection

[Server-side template injection](https://portswigger.net/research/server-side-template-injection) is a vulnerability where the attacker injects malicious input into a template in order to execute commands on the server.
- SSTI is an exploitation technique where the attacker injects native (to the Template Engine) code into a web page. The code is then run via the Template Engine and the attacker gains code execution on the affected server.
- This attack is very common on `Node.js` websites.
- You must first determine **_if_** you have a Template Engine.

## Template Engines
- Template Engines are used to display dynamically generated content on a web page. They replace the variables inside a template file with actual values and display these values to the client.
- Template Engines, like all software, are prone to vulnerabilities, like for example Server Side Template Injection (SSTI).
- Link: [Various exploitation techniques for various different template engines.](https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection)
- That site states: 

> Identifying the template engine involves analyzing error messages or manually testing various language-specific payloads. Common payloads causing errors include `${7/0}`, `{{7/0}}`, and `<%= 7/0 %>`. Observing the server's response to mathematical operations helps pinpoint the specific template engine.

## Exploit: Via Burp Suite
- Following the previous link to [hacktriks' SSTI how-to page.](https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection).. 
- Follow his testing inputs to find out if your target sitew is using a Template Engine, and then which one.
- He has several Engines with specific exploit code.
- **Hack the Box: Bike** uses SSTI. 
