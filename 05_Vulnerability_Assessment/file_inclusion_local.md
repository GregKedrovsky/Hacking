# Local File Inclusion (LFI)
> LFI or Local File Inclusion occurs when an attacker is able to get a website to include a file that was not intended to be an option for this application. A common example is when an application uses the path to a file as input. If the application treats this input as trusted, and the required sanitary checks are not performed on this input, then the attacker can exploit it by using the `../` string in the inputted file name and eventually view sensitive files in the local file system. In some limited cases, an LFI can lead to code execution as well.

## Contents
- []()


## Test a Page Parameter

### [URL Parameters](https://www.semrush.com/blog/url-parameters/)

![original](https://github.com/GregKedrovsky/Hacking/assets/26492233/dc611cf7-9203-48a0-bf94-727adef865b5)

### Vulnerability
- If you have a URL that passes a `page=` parameter, test it to see if you can include a directory traversal to a known Windows file in a known Windows location.
- Example:
```
http://unika.htb/index.php?page=french.html
#                          |--> this page parameter directs to another file on the server
```

### Test the Vulnerability
- Test with commonly known files that have the same name across networks, Windows domains, and systems ([like these](https://github.com/carlospolop/Auto_Wordlists/blob/main/wordlists/file_inclusion_windows.txt)).
- Example of a vulnerable page parameter:
```
http://unika.htb/index.php?page=../../../../../../../../windows/system32/drivers/etc/hosts

# Positive Results:
# # Copyright (c) 1993-2009 Microsoft Corp. 
# # This is a sample HOSTS file used by Microsoft TCP/IP for Windows. 
# # This file contains the mappings of IP addresses to host names. 
# # ...
# # 127.0.0.1 localhost # ::1 localhost
```
- The file inclusion, in this case, was made possible because in the backend the [include() method of PHP](https://www.php.net/manual/en/function.include.php) is being used to process the URL parameter `page` for serving a different webpage for different languages.
- The `include` statement takes all the text/code/markup that exists in the specified file and loads it into the memory, making it available for use.
- And because no proper sanitizing is being done on this `page` parameter, we were able to pass malicious input and therefore view the internal system files.

### Exploit
- We know that this web page is vulnerable to the file inclusion vulnerability and is being served on a Windows machine. Thus, there exists a potential for including a file on our attacker workstation.
- If we select a protocol like SMB, Windows will try to authenticate to our machine, and we can capture the NetNTLMv2.

