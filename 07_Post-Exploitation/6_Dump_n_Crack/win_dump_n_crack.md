# Windows: Dump & Crack Password Hashes

## Contents
- []()
- []()
- []()
- []()
- []()
- []()
- []()
- []()
- []()
- []()

## Intro

### Windows Password Hashes
- The Windows O/S stores hashed user account passwords locally in the SAM database.
  - `SAM` : Security Accounts Manager
- Hashing is the process of converting a piece of data into another value. A hashing function or algorith is used to generate the new value. The result of a hashing algorithm is know as a **_hash_** or a **_hash value_**.
- Authentication and verification of user credentials is facilitated by the LSA.
  - `LSA` : Local Security Authority
- This all ties into the LSASS process.
  - `LSASS` : Local Security Authority Subsystem Service
- Windows versions up to Windows Server 2003 utilize two different types of hashes:
  - `LM` : LAN Manager authentication protocol
  - `NTLM` : Network Trust Level Manager
- Windows disabled LM hashing and utilizes NTLM hashing from Windows Vista onward. 

### SAM Database
- The SAM (Security Account Manager) is a database file that is responsible for managing user accounts and passwords on Windows. All user account passwords stored in the SAM database are hashed.
  - The SAM database on Windows is similar to the `/etc/shadow` file on Linux
- The SAM database file cannot be copied while the operating system is running.
- The Windows NT kernel keeps the SAM database file locked and as a result, attackers typically utilize in-memory techniques and tools to dump SAM hashes from the LSASS process.
  - **NOTE:** Elevated/Administrative privileges are required in order to access and interact with the LSASS process.
  - You're probably going to need PrivEsc to be able to dump hashes.
- In modern versions of Windows, the SAM database is encrypted with a `syskey`.

### LM (LanMan -- LAN Manager authentication protocol)
- LM is the default hashing algorithm that was implemented in Windows operating systems prior to NT4.0.
- The protocol is used to hash user passwords, and the hashing process can be broken down into the following steps:
  - The password is broken into two seven-character chunks.
  - All characters are then converted into uppercase.
  - Each chunk is then hashed separated with the DES algorithm.
- LM hashing is generally considered to be a **_weak protocol_** and can easily be cracked, primarily because the password hash does not include salts, consequently making brute-force and rainbow table attacks effective against LM hashes.

### NTLM Hash (or just NTHash)
- NTML is a collection of authentication protocols that are utilized in Windows to facilitate authentication between computers. The authentication process involves using a valid username and password to authenticate successfully.
- From Windows Vista onwards, Windows disables LM hashing and utilizes NTLM hashing.
- When a user account is created, it is encrypted using the MD4 hashing algorithm, while the original password is disposed of.
- NTLM improves upon LM in the following ways:
  - Does not split the hash into two chunks
  - Case sensitive
  - Allows the use of symbols and unicode characters
- These hashes are stored in the SAM database.
- NTHashes do not use salts. Therefore they can be cracked relatively easily (brute-force or rainbow table).

----
## next

