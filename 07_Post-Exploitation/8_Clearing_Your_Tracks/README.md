# Clearing Your Tracks

## Contents
- [Keep Notes](#keep-notes)
- [Use a Temp Directory](#use-a-temp-directory)
- [Clean-Up on Windows](#clean-up-on-windows)
  - [Be Tidy](#be-tidy)
  - [Framework Artifcats](#framework-artifcats)
  - [Windows Event Logs](#windows-event-logs)
  - [Tip](#tip)
- [Clean-Up on Linux](#clean-up-on-linux)

## Keep Notes
- Keep notes of what you transferred and what the MSF put on the target system!
  - Make a separate note file of "Clean Up"
  - It should be a running list (add to it each time you do something that needs to be cleaned up afterward).
- And then at the end of the pentest, use this "Clean Up" note file as a check list to cover your tracks

## Use a Temp Directory
- Whenever you upload crap to Windows, do so to `\Temp`
- Whenever you upload crap to Linux, do so to `/tmp`
- Keep things tidy so you know where your junque is (to delete it when you're done with it).

## Clean-Up on Windows

### Be Tidy
- The exploitation and post-exploitation phases of a penetration test involved actively engaging with target systems and the data that is stored on these systems.
- As a result, you may be required to clear (undo) any changes you made to the target systems that you compromised.
  - This will usually be specified in the guidelines and specifics of the rules of engagement.
- If you transferred any files to the target systems that you compromised, keep track of where they have been saved so that you can remove them when you are finished.
  - A good practice is to store all your scripts, exploits, and binaries in the `C:\Temp` directory on Windows and in the `/tmp` directory on Linux.

### Framework Artifcats
- It is also important to consider the exploitation framework you are using.
  - An example of this is MSF, which is notorious for generating and storing artifacts on the target system when using exploit or post modules.
- Some well-designed MSF modules provide you with instructions and resource scripts that give you information regarding where the artifacts are stored and how they can be removed.
- In the context of Windows, a typical post-exploitation technique pertinent to clearing your tracks is to delete the Windows Event Log.
  - This is something that should be avoided during a penetration test since the Windows Event Log stores a lot of data that is important to the client you are performing the pentest for.

### Windows Event Logs
- If you need to (and can) delete the Windows Event Logs, meterpreter has a function/command to do just that.
- Meterpreter command: `clearev`
- You need to run that from the meterpreter prompt (with access to the target).
- This will delete **_all_** the Windows Event Logs on the target system. So you better be sure... 

### Tip
- When performing a pentest, keep a specific note file (in your notetaking application) for "Clean Up."
- Every time you run an MSF module and it tells you where it put the script, binary or whatever, then copy and paste that into your note file.
- Then, at the end of the pentest, you just go through your "Clean Up" note file and clean up your tracks.

## Clean-Up on Linux
- Most of your MSF recourse scripts won't do a very good job of cleaning up after themselves on Linux. Therefore you'll likely need to do so manually.
- `~/.bash_history` : This file contains a history of commands executed in bash on the user's account.
  - You can see a list of the commands entered during your session by using the history command.
  - This history if volatile in the lab environment; it will be deleted when you log out
  - However, on a most standard Linux distros this history information is stored in the .bash_history file. Open that file in vim and delete the specific commands that might give you away.
  - Don't delete the whole file.
    - That would look suspicious.
    - Just weed out the commands that could tip off a sysadmin that he's been hacked.
  - `history -c` : clears the current history buffer/cache
