# Exploiting Windows

## Contents
- [Overview](#overview)
  - [Prime Target](#prime-target)
  - [Vulnerabilities](#vulnerabilities)
  - [Basic Types](#basic-types)
- [Frequently Exploited Services](#frequently-exploited-services)
- [IIS](#iis)

## Overview

### Windows... the prime target for attackers... 
- About 70% of all machines run Windows.
- There are lots of publicly available exploits out there that are relatively easy to use.
- So why not shoot the fish in the barrel--much larger target.

### Windows Vulnerabilities
- Because of the many and varied versions of Windows, the threat surface is fragmented (i.e., vulnerabilities in XP or Win7 won't be found in Win10).
  - The older the version, the more vulnerable it will be.
- However, all Windows versions share a likeness given in the development model and philosophy:
  - Developed in C (therefore vulnerable to buffer overflows, arbitrary code execution, etc.).
  - By default, Windows is not configured for security. It requires the user to proactively implement good security practices and configure the system for security. Who does that...?
  - Many systems are left unpatched, so zero-days are effective for a good long time.
- Because of the fragmented nature of Windows (new versions issued, leaving multiple versions out in the wild: Server 2008, 2012, etc.; WinXP, Vista, 2000, Win7, Win8, Win10, Win11), many companies are using older versions and those have an increasing number of (often unpatched) vulnerabilities.
- In addition, Windows is vulnerable to the cross-platform vulnerabiliteis common among attackers (e.g., SQL injection, etc.).
- And of course physical attacks like theft, malicious peripheral devices, etc. 

### Basic Types of Windows Vulnerabilities
1. **Information Disclosure:** Vulnerability that allows an attcker to access confidential data.
2. **Buffer Overflows:** Caused by a programming error that allows attackers to write data to a memory buffer and overrun the allocated space, thus writing data to other memory addresses.
3. **Remote Code Execution:** Vulnerability that allows an attacker to remotely execute code on the target system.
4. **Privilege Escalation:** Vulnerability that allows an attacker to elevate his privileges after an initial compromise. 
Denial of Service (DoS): Vulnerability that allows an attacker to consume a system/host's resources (RAM, CPU, Network, etc.) and thus preventing the system from functioning normally.

## Frequently Exploited Services
- Native Windows Services common to all Windows installations that are frequently exploited...
- This means we don't have to focus on third-party applications. We can utilize services and applications native to the operating system itself.
- For example... you should be familiar (at least) with the following.... 

| Protocol/Service | Ports | Purpose | 
| ---------------- | :---: | ------- |
| Microsoft IIS (Internet Information Service) | TCP ports 80/443 | Proprietary web server software developed by Microsoft that runs on Windows |
| WebDAV (Web Distributed Authoring & Versioning) | TCP ports 80/443 | HTTP extension that allows clients to update, delete, move, and copy files on a web server. WebDAV is used to enable a web server to act as a file server. |
| SMB/CIFS (Server Message Block protocol) | TCP port 445 | Network file sharing protocol that is used to facilitate the sharing of files and peripherals between computers on a local network (LAN). |
| RDP (Remote Desktop Protocol) | TCP port 3389 | Proprietary GUI remote access protocol developed by Microsoft and is used to remotely authenticate and interact with a Windows system. |
| WinRM (Windows Remote Management protocol) | TCP ports 5986/443 | Windows remote management protocol that can be used to facilitate remote access with Windows systems. |

## IIS
> Microsoft IIS -- Internet Information Services
- Proprietary extensible web server software built by Microsoft for Windows NT Family.
- Used to host websites, web apps, etc.
  - Managed via a "robust" GUI
- Can host static or dynamic web pages (dynamic via ASP.NET and/or PHP).
- Default Ports:
  - Port 80: http
  - Port 443: https  (if you have an SSL certificate installed)
- Supported executable file extentions:
  - .asp
  - .aspx
  - .config
  - .php

