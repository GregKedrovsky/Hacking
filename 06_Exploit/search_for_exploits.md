# Searching for Exploits

**This is your next step:**
1. You did your host discovery and found a target.
2. You scanned your target and found open ports.
3. You scanned those ports for service and service version information.
4. You then took that service/version info and found what might be an exploitable vulnerability.
5. Now... you need to search for some potential exploits.

## Contents
- [Searching for Public Exploits](#searching-for-public-exploits)
  - [Exploit-DB](#exploit-db)
  - [Rapid7](#rapid7)
  - [Google Dorks](#google-dorks)
  - [Packet Storm](#packet-storm)
- [SearchSploit](#searchsploit)
  - [Locally Stored](#locally-stored)
  - [1: Update Your Distro](#1-update-your-distro)
  - [2: Update SearchSploit](#2-update-searchsploit)
  - [Basic Syntax](#basic-syntax)
  - [Results](#results)
  - [Copy the Exploit](#copy-the-exploit)
  - [Search Terms](#search-terms)
  - [Search Filters](#search-filters)
  - [Show URLs](#show-urls)

## Searching for Public Exploits
- After identifying a potential vulnerability within a target or a service running on a target, the next logical step will involve searching for exploit code that can be used to exploit the vulnerability.
- Exploit code can easily be found online.
  - However, it is important to note that downloading and running exploit code against a target can be quite dangerous.
  - It is therefore recommended to analyze the exploit code closely to ensure that it works as intended.
- There are a handful of legitimate and vetted exploit databases that you should use when searching for exploits online...

### [Exploit-DB](https://www.exploit-db.com/)
- This is an online, comprehensive database of publicly available exploits. 

### [Rapid7](https://www.rapid7.com/db/)
- Rapid7 owns and maintains the MetaSploit project
- Search this db for exploits.
  - NOTE: The "Type" filter includes: Module and Vulnerability
- This db is a repo of "vetted" exploits and exploitable vulnerabilities.
- This is the best place to look for exploits available in Metasploit modules.

### [Google Dorks](../01_Recon/recon1_passive.md#google-dorks)
- Remember that you can fine tune your Google searches to find what you need from sites you trust.
- Sites you can search:
  - `site:exploit-db.com`
  - `site:rapid7.com`
  - `site:github.com`  (which is a bit of a crap shoot for finding legit code)

### [Packet Storm](https://packetstormsecurity.com/)
- This is not really an exploit database.
- It is an information security website that provides you with information about new vulnerabilities.

## [SearchSploit](https://www.exploit-db.com/searchsploit)

- In certain cases you may not have access to online exploits and as a result, you must be able to use the exploit sources available locally (off-line).
- The entire Exploit-db database of exploits comes pre-packaged with Kali LInux.
  - This provides you with all the exploits locally that you can find on exploit-db.com
- The Exploit-db offline database of exploits can be accessed and queried with a tool called `SearchSploit`.

### Locally Stored

- The exploits are stored locally here: `/usr/share/exploitdb`
- There are two subdirs in that directory:
  - `/usr/share/exploitdb/exploits`
    - Further organized by operating system, architecture, and the programming language of the exploit.
  - `/usr/share/exploitdb/shellcodes`
- The tool provided to search this directory tree: `searchsploit `

### 1: Update Your Distro

- Remember to update your distro before searching.
- The entirety of Exploit-db come prepackaged with Kali Linux
- To make sure you have all (including the latest) exploits locally, you should update your distro.
```
# [1] Update package repo
apt update

# [2] Upgrade your distro
apt full-upgrade -y

# [3] Remove obsolete packages left after the upgrade 
apt autoremove

# [4] Clear local repo of useless package files
apt autoclean

# Or do it all in one line:
apt update && apt full-upgrade -y && apt autoremove && apt autoclean
```

### 2: Update SearchSploit
- Update SearchSploit before you do much anything else...
```
searchsploit -u
```

### Basic Syntax
```
searchsploit [term / service]
# Example:
searchsploit vsftpd
# Example (narrow down a broad search with version information)
searchsploit vsftpd 2.3.4  
```

### Results
- Results are tabulated in two columns: Exploit Title & Path
- The "Path" column contains the local path where you can find the exploit file reference.
- All these paths will be relative to: `/usr/share/exploitdb`

### Copy the Exploit
- To copy an exploit into your current directory:
```
searchsploit -m [EDB-ID#]
```
- `-m` : mirror (copy) an exploit to the current working directory (pwd)
- You can then edit the exploit and access the code without jacking up the original copy.

### Search Terms
- Use SearchSploit search terms to narrow down your searches based on what you're looking for.

#### Case sensitive search: `-c` option
```
searchsploit -c OpenSSH
```

#### Title search:  `-t` option
  - This forces searchsploit to search only the title for your search term that follows.
  - By default searchsploit searches title and the file's path.
```
searchsploit -t vsftpd
searchsploit -t Buffer Overflow 
```

#### Exact Search Option: `-e` option
  - Perform an exact and order match on exploit title (default is  an AND match on each term)
  - e.g. "WordPress 4.1" would not be detect "WordPress Core 4.1")
  - This option implies `-t`. 
```
searchsploit -e "Windows XP"   # searches for the exact term
```

### Search Filters
- The Exploit-db.com web interface allows you to use filters to refine your search results.
- SearchSploit allows you to include any of the terms in your command line search
- For example:
  - Type: dos, local, remote, webapps
  - Platform: any of the listed operating systems (e.g., windows, linux)
- Example:
```
searchsploit remote windows smb
```

### Show URLs
- Default results give you the local path to the exploit.
- Example: This givess you three results within the local directory structure...
```
searchsploit remote windows smb | grep -e "EternalBlue"
```
- To see the ful online URL instead of the path:  `-w`  or  `--www`
```
searchsploit -w remote windows smb | grep -e "EternalBlue"
```
